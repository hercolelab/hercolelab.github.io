{{/* layouts/blocks/team.html */}}
{{ $page      := .wcPage }}
{{ $block     := .wcBlock }}
{{ $folder    := $block.content.folder | default "team" }}
{{ $columns   := $block.design.columns | default 3 }}
{{ $gap       := $block.design.gap | default "8" }}

{{/* Recupera la sezione indicata */}}
{{ $section := site.GetPage "Section" $folder }}
{{ if not $section }}
  {{ errorf "Sezione ‘%s’ non trovata. Crea content/%s/ con i profili." $folder $folder }}
{{ end }}

{{/* Tutte le pagine markdown al livello immediato (una cartella = un profilo) */}}
{{ $profiles := $section.RegularPages }}

{{/* (Eventuali filtri personalizzati, se ti servono) */}}
{{ with $block.content.filters }}
  {{ if .tags }}    {{ $profiles = where $profiles "Params.tags" "intersect" .tags }}    {{ end }}
  {{ if .featured }}{{ $profiles = where $profiles "Params.featured" .featured }}{{ end }}
{{ end }}

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-{{ $columns }} gap-{{ $gap }} px-6">
  {{ range $profiles }}
    <div class="flex flex-col items-center text-center p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-lg">
      {{ with .Params.avatar }}
        <img src="{{ . | relURL }}" alt="{{ $.Title }}" class="w-32 h-32 rounded-full object-cover mb-4"/>
      {{ end }}
      <h3 class="text-xl font-semibold">{{ .Title }}</h3>
      {{ with .Params.organization }}
        <p class="text-sm text-gray-500">{{ . }}</p>
      {{ end }}
      {{ with .Params.role }}
        <p class="mt-1 text-gray-700 dark:text-gray-300">{{ . }}</p>
      {{ end }}
      {{ with .Params.social }}
        <div class="flex space-x-4 mt-3">
          {{ range . }}
            <a href="{{ .url }}" target="_blank" rel="noopener noreferrer" aria-label="{{ .name }}">
              {{/* Assumiamo che .icon sia il nome di un’icona lucide-react o simile */}}
              <i class="icon-{{ .icon }} w-6 h-6"></i>
            </a>
          {{ end }}
        </div>
      {{ end }}
    </div>
  {{ end }}
</div>
