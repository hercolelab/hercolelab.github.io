{{ $usernames := .usernames }}
{{ $ctx := .parent }}

{{ if gt (len $usernames) 0 }}
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 px-6 md:px-0">
    {{ range $u := $usernames }}
      {{/* Carica la pagina dell'autore */}}
      {{ $author := site.GetPage "section" "authors" | where "File.BaseFileName" $u | first }}
      {{ if not $author }}
        {{/* in alternativa: site.GetPage "page" (printf "authors/%s/index.md" $u) */}}
      {{ end }}

      <div class="text-center bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md">
        {{ with $author.Resources.ByType "image" | first }}
          {{ $img := .Fill "150x150 Center" }}
          <a href="{{ $author.RelPermalink }}">
            <img
              class="mx-auto rounded-full bg-white dark:bg-gray-700 p-1 cursor-pointer"
              src="{{ $img.RelPermalink }}"
              width="{{ $img.Width }}"
              height="{{ $img.Height }}"
              alt="{{ $author.Title }}"
            >
          </a>
        {{ end }}

        <h2 class="mt-4 text-xl font-bold">
          <a
            href="{{ $author.RelPermalink }}"
            class="text-blue-600 underline hover:text-blue-800 cursor-pointer"
          >
            {{ $author.Title }}
          </a>
        </h2>

        {{ with $author.Params.role }}
          <div class="text-sm text-gray-600 dark:text-gray-300 mb-2">{{ . }}</div>
        {{ end }}

        {{ with $author.Params.organizations }}
          <ul class="text-sm mb-2">
            {{ range . }}
              <li>
                {{ with .url }}<a href="{{ . }}" target="_blank" rel="noopener">{{ end }}
                  {{ .name }}
                {{ if .url }}</a>{{ end }}
              </li>
            {{ end }}
          </ul>
        {{ end }}

        {{ with $author.Params.profiles }}
          <ul class="flex justify-center space-x-3 text-xl mt-2">
            {{ range . }}
              <li>
                <a href="{{ .url }}" target="_blank" rel="noopener">
                  {{ partial "functions/get_icon" (dict "name" .icon "attributes" "style='height:1.5rem;'") }}
                </a>
              </li>
            {{ end }}
          </ul>
        {{ end }}
      </div>
    {{ end }}
  </div>
{{ end }}